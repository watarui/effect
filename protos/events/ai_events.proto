syntax = "proto3";

package effect.events.ai;

import "common/events.proto";
import "common/learning_types.proto";

// AI タスク作成イベント
message TaskCreated {
  effect.common.EventMetadata metadata = 1;
  string task_id = 2; // UUID（EventId）
  effect.common.AITaskType task_type = 3;
  string target_id = 4; // 対象のID（例：ItemId）
}

// AI タスク開始イベント
message TaskStarted {
  effect.common.EventMetadata metadata = 1;
  string task_id = 2; // UUID（EventId）
  string provider = 3; // AI プロバイダー（例："openai", "anthropic"）
}

// AI タスク完了イベント
message TaskCompleted {
  effect.common.EventMetadata metadata = 1;
  string task_id = 2; // UUID（EventId）
  uint64 duration_ms = 3; // 処理時間（ミリ秒）
}

// AI タスク失敗イベント
message TaskFailed {
  effect.common.EventMetadata metadata = 1;
  string task_id = 2; // UUID（EventId）
  string error = 3; // エラーメッセージ
  uint32 retry_count = 4; // リトライ回数
}

// AI 統合コンテキストのイベント
message AIIntegrationEvent {
  oneof event {
    TaskCreated task_created = 1;
    TaskStarted task_started = 2;
    TaskCompleted task_completed = 3;
    TaskFailed task_failed = 4;
  }
}
